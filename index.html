<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Daily Food Quality & Taste Check — Konarak F&B</title>

<!-- jsPDF + AutoTable -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

<style>
  body {
    margin: 0;
    padding: 0;
    background: #f6f6f6;
    font-family: Arial, Helvetica, sans-serif;
  }

  .container {
    max-width: 820px;
    margin: 22px auto;
    background: #fff;
    padding: 18px 22px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.15);
    border-radius: 4px;
  }

  /* HEADER — Same Style as Sales Website */
  .header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 6px 0;
  }

  .header-left img {
    max-height: 48px;
    width: auto;
    display: block;
  }

  .header-center {
    flex: 1;
    text-align: center;
    font-size: 20px;
    font-weight: 700;
    padding: 0 10px;
    line-height: 1.2;
  }

  .header-right {
    width: 48px;
  }

  @media (max-width: 480px) {
    .header-left img {
      max-height: 38px;
    }
    .header-center {
      font-size: 16px;
    }
    .header-right {
      width: 38px;
    }
  }

  /* Meta fields */
  .meta-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    margin-top: 20px;
    margin-bottom: 20px;
  }
  .meta-item {
    flex: 1 1 160px;
  }
  .meta-item label {
    display: block;
    font-weight: 600;
    font-size: 14px;
    margin-bottom: 4px;
  }
  .meta-item input {
    width: 100%;
    padding: 8px 10px;
    border: 1px solid #bbb;
    border-radius: 4px;
    font-size: 14px;
    box-sizing: border-box;
  }

  /* Table */
  .table-wrap {
    overflow-x: auto;
    margin-bottom: 20px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    min-width: 900px;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 8px;
    font-size: 14px;
    text-align: center;
  }
  th {
    background: #f3f3f3;
    font-weight: 600;
  }
  table input, table select {
    width: 100%;
    padding: 6px;
    box-sizing: border-box;
  }

  .btn-del {
    background: #d9534f;
    color: #fff;
    border: none;
    padding: 6px 8px;
    border-radius: 4px;
    cursor: pointer;
  }

  .controls button {
    padding: 10px 14px;
    font-size: 15px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin-right: 6px;
  }
  .btn-add { background:#198754; color:#fff; }
  .btn-save { background:#0d6efd; color:#fff; }
  .btn-pdf { background:#ff9800; color:#fff; }

  /* Notes Boxes */
  .note-box {
    width: 100%;
    border: 1px solid #999;
    padding: 10px;
    margin-bottom: 14px;
    border-radius: 4px;
    background: #fafafa;
  }
  .note-box h4 {
    margin: 0 0 6px;
    font-size: 14px;
    font-weight: 600;
  }
  .note-box textarea {
    width: 100%;
    min-height: 90px;
    padding: 8px;
    font-size: 14px;
    border: 1px solid #999;
    border-radius: 4px;
    resize: vertical;
    box-sizing: border-box;
  }

  /* Footer */
  .footer-row {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
    margin-top: 14px;
  }
  .footer-box {
    flex: 1 1 200px;
    border: 1px solid #bbb;
    padding: 10px;
    background: #fafafa;
    border-radius: 4px;
    min-height: 48px;
  }
</style>
</head>
<body>

<div class="container">

  <!-- HEADER -->
  <div class="header">
    <div class="header-left">
      <img src="logo.png" id="logoImg" alt="Logo" onerror="this.style.display='none'">
    </div>
    <div class="header-center">Daily Food Quality & Taste Check Report</div>
    <div class="header-right"></div>
  </div>

  <!-- META FIELDS -->
  <div class="meta-grid">
    <div class="meta-item"><label>Date</label><input id="date" type="date"></div>
    <div class="meta-item"><label>Building</label><input id="building" type="text"></div>
    <div class="meta-item"><label>Floor</label><input id="floor" type="text"></div>
    <div class="meta-item"><label>Counter</label><input id="counter" type="text"></div>
    <div class="meta-item"><label>Supervisor</label><input id="supervisor" type="text"></div>
    <div class="meta-item"><label>CBRE Representative</label><input id="cbre" type="text"></div>
  </div>

  <!-- TABLE -->
  <div class="table-wrap">
    <table id="foodTable">
      <thead>
        <tr>
          <th>S.No</th>
          <th>Item</th>
          <th>Temp (°C)</th>
          <th>Freshness</th>
          <th>Taste</th>
          <th>Texture</th>
          <th>Appearance</th>
          <th>Portion</th>
          <th>Remarks</th>
          <th>Del</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td><input type="text"></td>
          <td><input type="text"></td>
          <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
          <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
          <td><select><option>Soft</option><option>Normal</option><option>Hard</option></select></td>
          <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
          <td><select><option>Std</option><option>Less</option></select></td>
          <td><input type="text"></td>
          <td><button class="btn-del" onclick="deleteRow(this)">X</button></td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- BUTTONS -->
  <div class="controls">
    <button class="btn-add" onclick="addRow()">+ Add Row</button>
    <button class="btn-save" onclick="saveForm()">Save</button>
  </div>

  <!-- NOTES -->
  <div class="note-box">
    <h4>Taste Validation Notes</h4>
    <textarea id="tasteInput" oninput="syncNotes()"></textarea>
  </div>

  <div class="note-box">
    <h4>Special Observations</h4>
    <textarea id="obsInput" oninput="syncNotes()"></textarea>
  </div>

  <div class="note-box">
    <h4>Corrective Actions</h4>
    <textarea id="actionsInput" oninput="syncNotes()"></textarea>
  </div>

  <!-- Hidden for PDF -->
  <p id="tastePreview" style="display:none"></p>
  <p id="obsPreview" style="display:none"></p>
  <p id="actionsPreview" style="display:none"></p>

  <!-- FOOTER -->
  <div class="footer-row">
    <div class="footer-box">Vendor PoC :</div>
    <div class="footer-box">Verified by F&B Team :</div>
  </div>

  <!-- DOWNLOAD -->
  <div style="margin-top:20px;">
    <button class="btn-pdf" onclick="downloadPDF()">Download PDF</button>
  </div>

</div>


<script>
function addRow(){
  const tbody = document.querySelector("#foodTable tbody");
  const idx = tbody.rows.length + 1;
  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td>${idx}</td>
    <td><input type="text"></td>
    <td><input type="text"></td>
    <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
    <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
    <td><select><option>Soft</option><option>Normal</option><option>Hard</option></select></td>
    <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
    <td><select><option>Std</option><option>Less</option></select></td>
    <td><input type="text"></td>
    <td><button class="btn-del" onclick="deleteRow(this)">X</button></td>
  `;
  tbody.appendChild(tr);
}

function deleteRow(btn){
  const tr = btn.closest("tr");
  tr.remove();
  const rows = document.querySelectorAll("#foodTable tbody tr");
  rows.forEach((r,i)=> r.cells[0].textContent = i+1);
}

function syncNotes(){
  document.getElementById("tastePreview").innerText = document.getElementById("tasteInput").value;
  document.getElementById("obsPreview").innerText = document.getElementById("obsInput").value;
  document.getElementById("actionsPreview").innerText = document.getElementById("actionsInput").value;
}

function saveForm(){

  // lock table inputs
  document.querySelectorAll("#foodTable input").forEach(i => i.setAttribute("readonly","true"));
  document.querySelectorAll("#foodTable select").forEach(s => s.setAttribute("disabled","true"));

  // lock notes
  tasteInput.setAttribute("readonly", "true");
  obsInput.setAttribute("readonly", "true");
  actionsInput.setAttribute("readonly", "true");

  alert("Saved Successfully!");
}

async function downloadPDF(){

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ orientation:"landscape", unit:"pt", format:"a4" });

  const margin = 20;
  let cursorY = margin;

  doc.setFontSize(18);
  doc.setFont(undefined,"bold");
  doc.text("Daily Food Quality & Taste Check Report", 420, cursorY, {align:"center"});
  cursorY += 30;

  // META
  doc.setFontSize(11);
  doc.text(`Date: ${date.value}`, margin, cursorY);
  doc.text(`Building: ${building.value}`, 200, cursorY);
  doc.text(`Floor: ${floor.value}`, 380, cursorY);
  doc.text(`Counter: ${counter.value}`, 520, cursorY);
  cursorY += 20;
  doc.text(`Supervisor: ${supervisor.value}`, margin, cursorY);
  doc.text(`CBRE Rep: ${cbre.value}`, 260, cursorY);
  cursorY += 25;

  // TABLE
  const rows = Array.from(document.querySelectorAll("#foodTable tbody tr")).map((tr,i)=>{
    const t = tr.querySelectorAll("td");
    return [
      i+1,
      t[1].querySelector("input").value,
      t[2].querySelector("input").value,
      t[3].querySelector("select").value,
      t[4].querySelector("select").value,
      t[5].querySelector("select").value,
      t[6].querySelector("select").value,
      t[7].querySelector("select").value,
      t[8].querySelector("input").value
    ];
  });

  doc.autoTable({
    startY: cursorY,
    head:[["S.No","Item","Temp (°C)","Freshness","Taste","Texture","Appearance","Portion","Remarks"]],
    body: rows,
    margin:{left:margin, right:margin},
    styles:{fontSize:10, cellPadding:5}
  });

  cursorY = doc.lastAutoTable.finalY + 20;

  // NOTES
  doc.setFont(undefined,"bold"); doc.text("Taste Validation Notes:", margin, cursorY);
  doc.setFont(undefined,"normal");
  doc.text(doc.splitTextToSize(tastePreview.innerText, 750), margin, cursorY+12);
  cursorY += 50;

  doc.setFont(undefined,"bold"); doc.text("Special Observations:", margin, cursorY);
  doc.setFont(undefined,"normal");
  doc.text(doc.splitTextToSize(obsPreview.innerText, 750), margin, cursorY+12);
  cursorY += 50;

  doc.setFont(undefined,"bold"); doc.text("Corrective Actions:", margin, cursorY);
  doc.setFont(undefined,"normal");
  doc.text(doc.splitTextToSize(actionsPreview.innerText, 750), margin, cursorY+12);
  cursorY += 50;

  doc.save("Food_Quality_Check.pdf");
}
</script>

</body>
</html>
