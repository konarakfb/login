<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Daily Food Quality & Taste Check — Konarak F&B</title>

<!-- html2canvas + jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
  /* Sheet (fixed width matching PDF style) */
  body { font-family: Arial, Helvetica, sans-serif; background:#f2f2f2; padding:12px; }
  .page { width:100%; max-width:1000px; margin:auto; }
  .sheet {
    width: 820px;              /* PDF capture width */
    margin: auto;
    background: #fff;
    border: 2px solid #000;    /* Outer border (matches Dry Store) */
    padding: 10px;
    box-sizing: border-box;
  }

  /* HEADER — Single Row (Option 1) */
  .header-box {
    border: 1px solid #000;
    padding: 6px 10px;
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: nowrap;
  }
  .logo-area { flex:0 0 90px; display:flex; justify-content:center; }
  .logo-area img { max-height:60px; width:auto; display:block; }
  .title-area {
    flex:1;
    text-align:center;
    font-weight:700;
    font-size:20px;
    white-space:nowrap;
  }
  .header-space { flex:0 0 90px; }

  /* METADATA */
  .meta-row {
    display:flex;
    gap:0;
    margin-top:8px;
    border:1px solid #000;
    flex-wrap:wrap;
  }
  .meta-col {
    flex:1 1 200px;
    border-right:1px solid #000;
    padding:6px;
    box-sizing:border-box;
    min-width:150px;
  }
  .meta-col:last-child { border-right:none; }
  .meta-label { font-weight:700; font-size:13px; }
  .meta-col input {
    width:100%; padding:5px; margin-top:3px;
    border:1px solid #666; border-radius:3px; font-size:13px;
  }

  /* TABLE */
  .table-wrap { margin-top:10px; overflow-x:auto; }
  table { border-collapse:collapse; width:780px; }
  th, td {
    border:1px solid #000; padding:5px; font-size:12px;
    white-space:nowrap; text-align:center;
  }
  th { background:#e6e6e6; font-weight:700; }
  table input, table select {
    width:95%; padding:3px; font-size:12px;
  }

  /* FOOTER BOXES */
  .footer {
    display:flex;
    gap:8px;
    margin-top:12px;
  }
  .footer .box {
    flex:1 1 200px;
    border:1px solid #000;
    padding:6px;
    min-height:32px;
  }

  /* NOTES */
  .notes { margin-top:12px; }
  .notes textarea {
    width:100%; min-height:70px; padding:6px;
    border:1px solid #555; border-radius:3px;
  }
  .notes label { font-weight:700; margin-bottom:5px; display:block; }

  /* BUTTONS (placed LAST per your request) */
  .controls {
    display:flex;
    gap:10px;
    margin-top:14px;
    flex-wrap:wrap;
  }
  button {
    padding:10px 12px;
    font-size:14px;
    border:none;
    border-radius:4px;
    color:#fff;
    cursor:pointer;
  }
  .btn-add { background:#138000; }
  .btn-save { background:#0b66c3; }
  .btn-pdf  { background:#cc7a00; }
  .btn-del  { background:#b30000; padding:4px 6px; font-size:12px; }
</style>
</head>

<body>
<div class="page">
<div class="sheet" id="sheet">

  <!-- HEADER -->
  <div class="header-box">
    <div class="logo-area">
      <img src="logo.png" alt="Cognizant Logo" />
    </div>

    <div class="title-area">Daily Food Quality & Taste Check Report</div>

    <div class="header-space"></div>
  </div>

  <!-- METADATA -->
  <div class="meta-row">
    <div class="meta-col">
      <div class="meta-label">Date</div>
      <input type="date" id="date">
    </div>
    <div class="meta-col">
      <div class="meta-label">Building</div>
      <input type="text" id="building" placeholder="">
    </div>
    <div class="meta-col">
      <div class="meta-label">Floor / Counter</div>
      <input type="text" id="floor">
    </div>
    <div class="meta-col">
      <div class="meta-label">Supervisor</div>
      <input type="text" id="supervisor">
    </div>
    <div class="meta-col">
      <div class="meta-label">CBRE Representative</div>
      <input type="text" id="cbre">
    </div>
  </div>

  <!-- TABLE -->
  <div class="table-wrap">
    <table id="foodTable">
      <thead>
        <tr>
          <th style="width:40px">S.No</th>
          <th style="width:220px">Item</th>
          <th style="width:70px">Temp</th>
          <th style="width:90px">Freshness</th>
          <th style="width:80px">Taste</th>
          <th style="width:80px">Texture</th>
          <th style="width:80px">Appearance</th>
          <th style="width:70px">Portion</th>
          <th style="width:140px">Remarks</th>
          <th style="width:50px">Del</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td><input type="text"></td>
          <td><input type="text"></td>
          <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
          <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
          <td><select><option>Soft</option><option>Normal</option><option>Hard</option></select></td>
          <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
          <td><select><option>Std</option><option>Less</option></select></td>
          <td><input type="text"></td>
          <td><button class="btn-del" onclick="deleteRow(this)">X</button></td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- NOTES -->
  <div class="notes">
    <label for="tasteNotes">Taste Validation Notes</label>
    <textarea id="tasteNotes"></textarea>

    <label for="obs">Special Observations</label>
    <textarea id="obs"></textarea>

    <label for="actions">Corrective Actions</label>
    <textarea id="actions"></textarea>
  </div>

  <!-- FOOTER -->
  <div class="footer">
    <div class="box">Vendor PoC :</div>
    <div class="box">Verified by F&B Team :</div>
  </div>

  <!-- CONTROLS AT VERY BOTTOM -->
  <div class="controls">
    <button class="btn-add" onclick="addRow()">+ Add Row</button>
    <button class="btn-save" onclick="saveForm()">Save</button>
    <button class="btn-pdf" onclick="downloadPDF()">Download PDF</button>
  </div>

</div>
</div>

<script>
/* ───────────── ROW ADD / DELETE ───────────── */
function addRow(){
  const tbody = document.querySelector("#foodTable tbody");
  const idx = tbody.rows.length + 1;
  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td>${idx}</td>
    <td><input type="text"></td>
    <td><input type="text"></td>
    <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
    <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
    <td><select><option>Soft</option><option>Normal</option><option>Hard</option></select></td>
    <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
    <td><select><option>Std</option><option>Less</option></select></td>
    <td><input type="text"></td>
    <td><button class="btn-del" onclick="deleteRow(this)">X</button></td>
  `;
  tbody.appendChild(tr);
}

function deleteRow(btn){
  const tr = btn.closest("tr");
  tr.remove();
  // reindex
  document.querySelectorAll("#foodTable tbody tr").forEach((r,i)=> {
    r.cells[0].innerText = i+1;
  });
}

/* ───────────── LOCAL SAVE ───────────── */
function saveForm(){
  alert("Form saved locally.");
}

/* ───────────── LANDSCAPE PDF EXACT DRY STORE STYLE ───────────── */
async function downloadPDF(){
  const sheet = document.getElementById("sheet");

  const canvas = await html2canvas(sheet, {
    scale:2,
    useCORS:true,
    backgroundColor:"#ffffff"
  });

  const imgData = canvas.toDataURL("image/jpeg", 0.90);

  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF("l", "pt", "a4");  // LANDSCAPE A4

  const pageWidth = pdf.internal.pageSize.getWidth();
  const pageHeight = pdf.internal.pageSize.getHeight();

  const imgWidth = pageWidth - 20;
  const imgHeight = canvas.height * imgWidth / canvas.width;

  if(imgHeight < pageHeight){
    pdf.addImage(imgData, "JPEG", 10, 10, imgWidth, imgHeight, undefined, "FAST");
  } else {
    let y = 0;
    const hPx = canvas.height;
    const sliceHeightPx = Math.floor(pageHeight * canvas.width / pageWidth);

    while(y < hPx){
      const sliceCanvas = document.createElement("canvas");
      sliceCanvas.width = canvas.width;
      sliceCanvas.height = Math.min(sliceHeightPx, hPx - y);

      const ctx = sliceCanvas.getContext("2d");
      ctx.drawImage(canvas, 0, y, canvas.width, sliceCanvas.height, 0, 0, canvas.width, sliceCanvas.height);

      const sliceImg = sliceCanvas.toDataURL("image/jpeg", 0.90);
      const sliceImgHeight = sliceCanvas.height * imgWidth / sliceCanvas.width;

      if(y > 0) pdf.addPage();
      pdf.addImage(sliceImg, "JPEG", 10, 10, imgWidth, sliceImgHeight, undefined, "FAST");

      y += sliceHeightPx;
    }
  }

  pdf.save("Food_Quality_Check.pdf");
}
</script>

</body>
</html>
