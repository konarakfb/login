<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>CTS Cafeteria - Food Feedback Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- PDF LIBRARIES -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    :root{
      --accent:#f28c2b;
      --accent-soft:#fff3e6;
      --border:#000;
      --bg:#f4f4f4;
      --text:#111;
      --muted:#666;
    }

    *{box-sizing:border-box;}

    body{
      margin:0;
      font-family: Arial, system-ui, sans-serif;
      background:var(--bg);
      color:var(--text);
      padding:12px;
    }

    .wrapper{
      max-width:1100px;
      margin:0 auto;
    }

    .top-bar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:10px;
      font-size:13px;
      color:var(--muted);
    }

    .sheet{
      background:#fff;
      border:1px solid var(--border);
      border-radius:10px;
      padding:20px;
      box-shadow:0 2px 6px rgba(0,0,0,0.08);
    }

    .header-box{
      border:1px solid var(--border);
      border-radius:10px;
      padding:14px;
      margin-bottom:14px;
    }

    .header-row{
      display:flex;
      align-items:center;
      gap:12px;
    }

    .logo-box{
      width:70px;
      height:70px;
      border:1px solid var(--border);
      border-radius:8px;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }

    .logo-box img{
      max-width:100%;
      max-height:100%;
      object-fit:contain;
    }

    .company-name{
      margin:0;
      font-size:18px;
      font-weight:bold;
      text-transform:uppercase;
      color:var(--accent);
    }

    .sub-title{
      margin:2px 0 6px;
      font-size:14px;
      font-weight:bold;
      color:#333;
    }

    .form-title{
      margin:0;
      font-size:16px;
      font-weight:bold;
      text-align:center;
      text-transform:uppercase;
      border-top:1px solid #000;
      margin-top:6px;
      padding-top:6px;
      color:var(--accent);
    }

    .meta-row{
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:10px;
      margin-top:10px;
      font-size:12px;
    }

    .meta-item label{font-weight:bold;margin-bottom:2px;display:block;}

    .meta-item input, .meta-item select{
      width:100%;
      padding:6px;
      border:1px solid #000;
      border-radius:4px;
      font-size:12px;
    }

    .section-title{
      margin:16px 0 6px;
      padding:6px 8px;
      font-weight:bold;
      font-size:13px;
      background:var(--accent-soft);
      border-left:4px solid var(--accent);
      text-transform:uppercase;
    }

    .question-table{
      width:100%;
      border-collapse:collapse;
      font-size:12px;
      margin-bottom:12px;
    }

    .question-table td, .question-table th{
      border:1px solid #000;
      padding:6px;
      vertical-align:top;
    }

    .question-table th{
      background:#fff7ef;
      text-align:center;
      font-weight:bold;
    }

    .question-label{font-weight:bold;margin-bottom:3px;display:block;}

    .option-group{
      display:flex;
      flex-wrap:wrap;
      gap:10px 16px;
      margin-top:4px;
    }

    .text-row{
      display:flex;
      gap:8px;
      font-size:12px;
      margin-bottom:10px;
    }

    .text-row label{
      width:150px;
      font-weight:bold;
      padding-top:4px;
    }

    .text-row textarea{
      flex:1;
      min-height:60px;
      border:1px solid #000;
      border-radius:4px;
      padding:6px;
    }

    .footer-note{
      border-top:1px solid #000;
      margin-top:10px;
      padding-top:6px;
      font-size:11px;
      display:flex;
      justify-content:space-between;
    }

    .actions{
      display:flex;
      justify-content:center;
      margin-top:14px;
      gap:10px;
      flex-wrap:wrap;
    }

    .btn{
      padding:8px 20px;
      border-radius:999px;
      cursor:pointer;
      border:1px solid var(--accent);
      font-weight:600;
      background:#fff;
      color:var(--accent);
    }

    .btn-primary{
      background:var(--accent);
      color:#fff;
    }

    @media(max-width:768px){
      .meta-row{grid-template-columns:repeat(2,1fr);}
      .text-row{flex-direction:column;}
      .text-row label{width:auto;}
      .footer-note{flex-direction:column;}
    }

    @media(max-width:480px){
      .meta-row{grid-template-columns:1fr;}
    }
  </style>
</head>

<body>
<div class="wrapper">

  <div class="top-bar">
    <div>Food Feedback Form</div>
    <div>Date: <span id="today-span"></span></div>
  </div>

  <div id="pdf-area" class="sheet">

    <!-- HEADER -->
    <div class="header-box">
      <div class="header-row">
        <div class="logo-box"><img src="logo1.png"></div>
        <div class="title-block">
          <h1 class="company-name">CTS CAFETERIA</h1>
          <p class="sub-title">Operated by Konarak Food & Beverages</p>
          <p class="form-title">FOOD FEEDBACK FORM</p>
        </div>
      </div>

      <div class="meta-row">
        <div class="meta-item"><label>Food Item Name</label><input id="food-item"></div>
        <div class="meta-item"><label>Building</label><input id="building"></div>
        <div class="meta-item"><label>Floor</label><input id="floor"></div>
        <div class="meta-item"><label>Counter</label><input id="counter"></div>
        <div class="meta-item"><label>Employee Name</label><input id="emp-name"></div>
        <div class="meta-item"><label>Employee ID</label><input id="emp-id"></div>
        <div class="meta-item"><label>Department</label><input id="dept"></div>
        <div class="meta-item">
          <label>Meal Type</label>
          <select id="meal-type">
            <option value="">Select</option>
            <option>Breakfast</option>
            <option>Lunch</option>
            <option>Dinner</option>
            <option>Snacks</option>
          </select>
        </div>
      </div>
    </div>

    <!-- FOOD QUALITY -->
    <div class="section-title">Food Quality</div>

    <table class="question-table">
      <thead><tr><th>Parameter</th><th>Feedback</th></tr></thead>
      <tbody>
        <tr><td><span class="question-label">Taste</span><small>Overall taste of the food served.</small></td>
          <td><div class="option-group"><label><input type="radio" name="taste"> Excellent</label><label><input type="radio" name="taste"> Good</label><label><input type="radio" name="taste"> Average</label><label><input type="radio" name="taste"> Poor</label></div></td></tr>

        <tr><td><span class="question-label">Freshness</span><small>Did the food feel fresh?</small></td>
          <td><div class="option-group"><label><input type="radio" name="fresh"> Yes</label><label><input type="radio" name="fresh"> Partially</label><label><input type="radio" name="fresh"> No</label></div></td></tr>

        <tr><td><span class="question-label">Temperature</span></td>
          <td><div class="option-group"><label><input type="radio" name="temp"> Hot</label><label><input type="radio" name="temp"> Warm</label><label><input type="radio" name="temp"> Cold</label></div></td></tr>

        <tr><td><span class="question-label">Portion Size</span></td>
          <td><div class="option-group"><label><input type="radio" name="portion"> Adequate</label><label><input type="radio" name="portion"> More</label><label><input type="radio" name="portion"> Less</label></div></td></tr>

        <tr><td><span class="question-label">Variety</span></td>
          <td><div class="option-group"><label><input type="radio" name="variety"> Very Good</label><label><input type="radio" name="variety"> Good</label><label><input type="radio" name="variety"> Needs Improvement</label><label><input type="radio" name="variety"> Poor</label></div></td></tr>
      </tbody>
    </table>

    <!-- HYGIENE -->
    <div class="section-title">Hygiene & Service</div>

    <table class="question-table">
      <tbody>
        <tr><td><span class="question-label">Staff Behaviour</span></td>
          <td><div class="option-group"><label><input type="radio" name="staff"> Excellent</label><label><input type="radio" name="staff"> Good</label><label><input type="radio" name="staff"> Average</label><label><input type="radio" name="staff"> Poor</label></div></td></tr>

        <tr><td><span class="question-label">Cafeteria Cleanliness</span></td>
          <td><div class="option-group"><label><input type="radio" name="clean"> Very Clean</label><label><input type="radio" name="clean"> Clean</label><label><input type="radio" name="clean"> Needs Improvement</label><label><input type="radio" name="clean"> Poor</label></div></td></tr>

        <tr><td><span class="question-label">Food Handling Hygiene</span></td>
          <td><div class="option-group"><label><input type="radio" name="hygiene"> Good</label><label><input type="radio" name="hygiene"> Satisfactory</label><label><input type="radio" name="hygiene"> Needs Improvement</label></div></td></tr>
      </tbody>
    </table>

    <!-- COMMENTS -->
    <div class="section-title">Additional Comments</div>
    <div class="text-row"><label>What did you like most?</label><textarea id="likes"></textarea></div>
    <div class="text-row"><label>Suggestions for improvement</label><textarea id="improve"></textarea></div>

    <!-- OVERALL -->
    <div class="section-title">Overall Rating</div>
    <div class="text-row"><label>Overall Rating</label>
      <div class="option-group"><label><input type="radio" name="overall"> 1</label><label><input type="radio" name="overall"> 2</label><label><input type="radio" name="overall"> 3</label><label><input type="radio" name="overall"> 4</label><label><input type="radio" name="overall"> 5</label></div>
    </div>

    <div class="text-row"><label>Signature (optional)</label><textarea id="signature"></textarea></div>

    <div class="footer-note">
      <div>Thank you for your valuable feedback. It helps us improve food quality & service.</div>
      <div><b>Form Code: KFB-001</b></div>
    </div>

  </div>

  <div class="actions">
    <button class="btn btn-primary" onclick="saveForm()">Save (Lock)</button>
    <button class="btn" onclick="resetForm()">Reset</button>
    <button class="btn" onclick="window.print()">Print</button>
    <button class="btn btn-primary" onclick="downloadPDF()">Download PDF</button>
  </div>

</div>

<script>

document.getElementById("today-span").textContent =
  new Date().toLocaleDateString("en-GB");

function saveForm(){
  document.querySelectorAll("#pdf-area input, #pdf-area textarea, #pdf-area select")
    .forEach(el => el.setAttribute("disabled","disabled"));
  alert("Form saved and locked.");
}

function resetForm(){
  document.querySelectorAll("#pdf-area input, #pdf-area textarea, #pdf-area select")
    .forEach(el => {
      el.removeAttribute("disabled");
      if(el.type==="radio") el.checked=false;
      else if(el.tagName==="SELECT") el.selectedIndex=0;
      else el.value="";
    });
  alert("Form reset.");
}

// ========================
// PDF EXPORT WITH MARGINS
// ========================
function downloadPDF(){
  const { jsPDF } = window.jspdf;
  const pdfArea = document.getElementById("pdf-area");

  html2canvas(pdfArea,{
    scale:3,
    useCORS:true,
    scrollY:-window.scrollY,
    backgroundColor:"#ffffff"
  }).then(canvas=>{

    const pdf = new jsPDF("p","mm","a4");
    const pageWidth = pdf.internal.pageSize.getWidth();
    const pageHeight = pdf.internal.pageSize.getHeight();

    const margin = 12;     // ⬅⬅⬅ ADD SPACE ALL SIDES
    const usableWidth = pageWidth - margin*2;

    const pxPerMm = canvas.width / usableWidth;
    const pageHeightPx = pageHeight * pxPerMm;

    let y = 0;
    let page = 0;

    while(y < canvas.height){
      const pageCanvas = document.createElement("canvas");
      pageCanvas.width = canvas.width;
      pageCanvas.height = Math.min(pageHeightPx, canvas.height - y);

      const ctx = pageCanvas.getContext("2d");
      ctx.drawImage(canvas,0,y,canvas.width,pageCanvas.height,0,0,canvas.width,pageCanvas.height);

      const imgData = pageCanvas.toDataURL("image/jpeg",0.95);
      const imgHeight = pageCanvas.height / pxPerMm;

      if(page > 0) pdf.addPage();

      pdf.addImage(
        imgData, "JPEG",
        margin, margin,                // X,Y margin
        usableWidth, imgHeight,        // scaled width & height
        undefined, "FAST"
      );

      y += pageHeightPx;
      page++;
    }

    pdf.save("Food_Feedback_Form_KFB-001.pdf");
  });
}

</script>

</body>
</html>
