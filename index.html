<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Daily Food Quality & Taste Check</title>

<!-- Stable jsPDF + html2canvas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f2f2f2;
        padding: 8px;
    }

    .form-box {
        background: #fff;
        padding: 12px;
        border: 1px solid #777;
        max-width: 900px;
        margin: auto;
    }

    /* Header */
    .header-flex {
        border: 1px solid #000;
        padding: 8px;
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: center;
        gap: 10px;
        text-align: center;
    }
    .header-flex img {
        height: 45px;
    }
    .header-title {
        font-size: 17px;
        font-weight: bold;
        width: 100%;
    }

    /* Input fields */
    .row {
        display: flex;
        flex-wrap: wrap;
    }
    .col {
        flex: 1;
        padding: 5px;
        min-width: 160px;
    }
    label {
        font-size: 13px;
        font-weight: bold;
    }
    input, select, textarea {
        width: 100%;
        padding: 4px;
        font-size: 13px;
        border: 1px solid #888;
        border-radius: 3px;
    }

    /* Table Fix: Scroll + Tight Cells + No Overflow */
    .table-container {
        width: 100%;
        overflow-x: auto;
    }

    table {
        width: 900px;  /* Fixed width = stops wrapping */
        border-collapse: collapse;
    }
    table th, table td {
        border: 1px solid #000;
        padding: 3px;
        font-size: 12px;
        white-space: nowrap; /* Prevent line break */
    }
    table th {
        background: #e6e6e6;
    }
    table input, table select {
        width: 95%;
        padding: 2px;
        font-size: 11px;
    }

    textarea { height: 65px; }

    button {
        padding: 10px;
        font-size: 15px;
        border: none;
        border-radius: 4px;
        color: #fff;
        width: 100%;
        margin-top: 10px;
    }
    .green { background: #0b7d2b; }
    .blue { background: #005ce6; }
    .orange { background: #cc7a00; }
    .red { background: #b30000; padding: 4px; font-size: 12px; width: 100%; }

</style>
</head>

<body>

<div class="form-box">

    <!-- Header -->
    <div class="header-flex">
        <img src="logo.png">
        <div class="header-title">Daily Food Quality & Taste Check Report</div>
    </div>

    <!-- Info Section -->
    <div class="row">
        <div class="col">
            <label>Date</label>
            <input type="date" id="date">
        </div>
        <div class="col">
            <label>Building</label>
            <input type="text" id="building">
        </div>
        <div class="col">
            <label>Floor / Counter</label>
            <input type="text" id="floor">
        </div>
    </div>

    <div class="row">
        <div class="col">
            <label>Supervisor Name</label>
            <input type="text" id="supervisor">
        </div>
        <div class="col">
            <label>CBRE Representative</label>
            <input type="text" id="cbre">
        </div>
    </div>

    <!-- TABLE -->
    <div class="table-container">
        <table id="foodTable">
            <thead>
            <tr>
                <th>S.No</th>
                <th>Item</th>
                <th>Temp</th>
                <th>Freshness</th>
                <th>Taste</th>
                <th>Texture</th>
                <th>Appearance</th>
                <th>Portion</th>
                <th>Remarks</th>
                <th>Delete</th>
            </tr>
            </thead>

            <tbody>
            <tr>
                <td>1</td>
                <td><input></td>
                <td><input></td>
                <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
                <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
                <td><select><option>Soft</option><option>Normal</option><option>Hard</option></select></td>
                <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
                <td><select><option>Standard</option><option>Less</option></select></td>
                <td><input></td>
                <td><button class="red" onclick="deleteRow(this)">X</button></td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- Add Row -->
    <button class="green" onclick="addRow()">+ Add Row</button>

    <!-- Notes -->
    <label style="margin-top:15px;">Taste Validation Notes</label>
    <textarea id="taste"></textarea>

    <label>Special Observations</label>
    <textarea id="obs"></textarea>

    <label>Corrective Actions</label>
    <textarea id="actions"></textarea>

    <!-- Buttons -->
    <button class="blue" onclick="saveForm()">Save</button>
    <button class="orange" onclick="downloadPDF()">Download PDF</button>

</div>


<!-- JAVASCRIPT -->
<script>
function addRow() {
    let table = document.getElementById("foodTable").getElementsByTagName("tbody")[0];
    let rowCount = table.rows.length;
    let row = table.insertRow();

    row.innerHTML = `
        <td>${rowCount + 1}</td>
        <td><input></td>
        <td><input></td>
        <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
        <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
        <td><select><option>Soft</option><option>Normal</option><option>Hard</option></select></td>
        <td><select><option>Good</option><option>Average</option><option>Poor</option></select></td>
        <td><select><option>Standard</option><option>Less</option></select></td>
        <td><input></td>
        <td><button class='red' onclick='deleteRow(this)'>X</button></td>
    `;
}

function deleteRow(btn) {
    let row = btn.parentNode.parentNode;
    row.remove();

    let rows = document.querySelectorAll("#foodTable tbody tr");
    rows.forEach((r, i) => r.cells[0].innerText = i + 1);
}

function saveForm() {
    alert("Saved successfully!");
}

async function downloadPDF() {
    const element = document.querySelector(".form-box");
    const canvas = await html2canvas(element, { scale: 1 });

    const imgData = canvas.toDataURL("image/jpeg", 0.7);
    const pdf = new jspdf.jsPDF("p", "pt", "a4");

    const pageWidth = pdf.internal.pageSize.getWidth();
    const imgWidth = pageWidth - 20;
    const imgHeight = (canvas.height * imgWidth) / canvas.width;

    pdf.addImage(imgData, "JPEG", 10, 10, imgWidth, imgHeight);
    pdf.save("Food_Quality_Check.pdf");
}
</script>

</body>
</html>
